# CoE Guide Agent 브리프

이 문서는 "나만의 개발 가이드 머신" 에이전트 컨셉을 빠르게 파악하고, 이후 구현을 이어갈 수 있도록 정리한 메모입니다.

## 에이전트 정체성
- 역할: 개발자의 작업 맥락을 이해하고, 프로젝트 규칙·ADR·문서 기반으로 즉시 실행 가능한 가이드를 제시하는 개인 시니어 엔지니어.
- 톤: 신뢰감 있고 간결한 설명, 필요 시 근거 링크와 구체 예시 포함.
- 사용자 적응: 프로필(선호 스택, 말투, 경력)을 학습해 중복 조언을 줄이고 맞춤 설명을 강화.

## 주요 동작 흐름
1. **Planner 노드** – 사용자 입력과 코드(diff 포함)를 분석해 필요한 지식 묶음과 도구를 선택하고, 단계별 체크리스트를 생성합니다.
2. **Knowledge 노드** – `docs/`, README, ADR, 스타일 가이드 등을 RAG로 검색하고 자주 쓰는 패시지를 세션 캐시에 보관합니다.
3. **Advisor 노드** – 분석 결과를 우선순위별 개선안과 근거(파일 경로, 문서 링크, 규칙)로 정리해 제공합니다.
4. **Feedback 노드** – 사용자가 수용한 조언과 편향을 기록해 이후 답변 품질을 높입니다.

## 모델 및 상태 초안
- `DeveloperContext`: 작업 경로, 대상 브랜치, 사용자 프로필 정보.
- `GuidanceRecommendation`: 제목, 상세 조언, 근거, 권장 행동, 중요도.
- `SessionMemory`: 최근 대화 요약, 이미 처리한 체크포인트, 사용자 피드백.
- LangGraph `AgentState`: 위 구조를 포함하도록 확장하고, Planner/Advisor 간 데이터 교환을 명시합니다.

## 구성 요소 계획
| 모듈 | 책임 | 초기 구현 아이디어 |
| --- | --- | --- |
| `core/agents/guide_agent/graph.py` | LangGraph 그래프 정의(Planner→Knowledge→Advisor→Feedback) | 백엔드 `tool_dispatcher` 흐름을 참고하되 노드별 함수로 분리 |
| `core/agents/guide_agent/nodes.py` | 노드별 로직(계획 수립, RAG 호출, 조언 생성, 피드백 기록) | RAG 호출은 `services/rag_client` 재사용, 스타일 검사는 신규 도구 추가 |
| `config/agent_profiles/*.yaml` | 사용자별 말투/선호 스택 정의 | CLI `--profile` 옵션과 연동 |
| `tools/style_rules_tool.py` | 스타일 가이드·린트 규칙 검사 | 기존 린트 스크립트 호출 혹은 정적 룰 매핑 |

## CLI 연동 메모
- 기본 명령: `python main.py --agent guide --profile <name> --context path/to/file.py` (추가 예정).
- 출력: JSON Lines 또는 Markdown 블록으로 권장 사항, 근거, 체크리스트를 순차 출력.
- 옵션: `--diff-file`, `--max-tips`, `--language=ko|en` 등 확장 고려.

## 테스트 아이디어
- `tests/agents/test_guide_agent_plan.py`: Planner가 diff 없이도 체크리스트를 생성하는지 확인.
- `tests/agents/test_guide_agent_advice.py`: 특정 규칙 위반 입력에 대해 근거 링크와 함께 경고를 반환하는지 검증.
- RAG 모듈은 목 데이터를 주입해 네트워크 의존성을 제거.

## 다음 작업 순서
1. `docs/agent_roles.md` 또는 위 파일을 기반으로 팀 내 리뷰.
2. `core/models.py`에 새 모델 및 타입 추가.
3. `core/agents/guide_agent/` 디렉터리를 만들고 그래프/노드 스켈레톤 작성.
4. 최소 기능(Planner→Advisor)만 연결한 MVP를 CLI로 테스트.
5. 세션 메모리, 사용자 프로필, 추가 도구를 점진적으로 확장.

> 체크리스트가 완료되면 이 파일에 "완료" 시간과 참고 커밋을 업데이트해 추후 진행 현황을 공유하세요.

## 스마트 & 엘레강스 강화를 위한 설계 메모
- **상황 적응형 브리핑**: 사용자의 최근 작업 흐름을 감지해 답변 형식을 자동 조정(예: 코드 리뷰 중이면 diff 중심, 설계 단계면 ADR 인용 비중 확대).
- **톤 조절 엔진**: 프로필에 기대 감성을 기록하고, 답변마다 "정확도 vs. 영감" 비율을 조정해 지루하지 않게 안내.
- **에너지 절약형 인터렉션**: 한 번의 질문에도 플랜, 리스크, 즉시 실행 가능한 스니펫을 세트로 묶어 제공해 추가 대화를 최소화.
- **프리미엄 UX 요소**: 응답 마지막에 "Next best action"과 "장기 개선 포인트"를 나눠 제시해 시니어의 조언 같은 여운을 남깁니다.

## 누구나 탐내게 만드는 차별화 포인트
1. **Explain & Teach 모드** – 사용자가 "왜?"를 묻지 않아도 매 조언에 최소 한 개의 근거와 학습 팁을 포함.
2. **개인 아카이브 기억력** – 세션 간 핵심 결정을 묶어 "오늘의 개발 노트" 초안을 자동 생성.
3. **예상 리스크 시뮬레이션** – 현재 변경이 가져올 실패 시나리오를 미리 계산해 테스트/롤백 전략을 추천.
4. **미니 멘토 피드백** – 사용자가 직접 해결한 항목에 대해 칭찬/격려 메시지를 맞춤 제공해 동기 부여.

## 고급 확장 로드맵 제안
- **Context Graph**: 파일, 테스트, 문서 간 관계를 그래프로 축적해 관련 영향 범위를 자동 표시.
- **멀티모달 입력**: 터미널 로그, 스크린샷, 다이어그램까지 받아들여 복합 이슈 가이드를 생성.
- **코드 생성 보조**: 조언 외에도 안전 장치가 있는 패치 제안을 PR 형태로 출력하도록 선택 옵션 제공.
- **운영 퍼포먼스 리포트**: 하루/주 단위로 에이전트 추천 대비 실제 행동률, 시간 절약 추정치를 집계해 대시보드로 노출.

> 위 확장 아이디어는 MVP 구현 뒤 우선순위를 논의하고, 실험 보드에 등록해 추적하세요.
